# win32

## C++/WinRT

C++17 language that provides the Windows Runtime APIs. This is included in projects as a single header file entry.

## Application menu

Useful link: https://learn.microsoft.com/en-us/windows/win32/menurc/using-menus.

Menu can be made one of two ways:
1. programatically, by stringing together several Windows API calls. 
2. Via a template included as a resource file. Window will handle the stringing together of API calls for you.

A Menu is a structure defined by MENUEX_TEMPLATE_HEADER, followed by one or more MENU_ITEM_TEMPLATE.
Process (Application)
	|________ MENUEX_TEMPLATE_HEADER
				|_________ MENU_ITEM_TEMPLATE
				|_________ MENU_ITEM_TEMPLATE
				|_________ MENU_ITEM_TEMPLATE
				|_________ MENU_ITEM_TEMPLATE
				...

LoadMenu function can be used to return a handler to the specified resource, which could then be assigned to a window. When created, this window will take ownership of any messages generated by the menu.

LoadMenu link:https://learn.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-loadmenua

```c++
HMENU LoadMenuA(
  [in, optional] HINSTANCE hInstance,
  [in]           LPCSTR    lpMenuName
);
```

The most common way of creating a menu is thorugh the CreateWindowEx function, but could also be done via SetMenu function. You cannot assign a menu to a child window.

### Creating the menu context

1. Add resource identifier, either to the header file or the main driver file.
```c++
#define IDM_MYMENURESOURCE   3
```
2. Create WinMain and include the window context and Message Procedure loop.
3. 
```c++
case WM_CONTEXTMENU: 
    if (!OnContextMenu(hwnd, GET_X_LPARAM(lParam),
              GET_Y_LPARAM(lParam))) 
        return DefWindowProc(hwnd, uMsg, wParam, lParam); 
    break; 
```